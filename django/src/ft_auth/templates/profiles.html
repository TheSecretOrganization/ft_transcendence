{% extends "./extends/base.html" %}

{% block content %}
<div class="pr-profile-container">
	<div class="pr-header">
		<div class="pr-profile-header-content">
			<div class="pr-profile-image-container">
				<img src="{{ target.avatar.url }}" alt="Profile Picture" class="pr-profile-image">
			</div>
			<div class="pr-profile-username">
				<h1>{{ target.username }}</h1>
			</div>
		</div>
	</div>

	<hr class="pr-divider">

	<div class="pr-profile-content">
		{% if games.count == 0 %}
		<p class="pr-no-games">Never played a game!</p>
		{% else %}
		<h2>Games history</h2>
		<p>Wins: <span id="wins">{{ wins }}</span></p>
		<p>Games Played: <span id="games-played">{{ games.count }}</span></p>
		<p>Win Percentage: <span id="win-percentage"></span></p>


		<div class="pr-game-scroll-container">
			<div class="pr-game-list">
				{% for game in games %}
				<div class="pr-game-card">
					<p>{{ game.user1.username }} vs {{ game.user2.username }}</p>
					<p>{{ game.score1 }} @ {{ game.score2 }}</p>
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}
	</div>
</div>

<script>
	// Get values from the HTML
	const wins = parseInt(document.getElementById('wins').textContent, 10);
	const gamesPlayed = parseInt(document.getElementById('games-played').textContent, 10);

	// Calculate win percentage
	let winPercentage = 0;
	if (gamesPlayed > 0) {
		winPercentage = (wins / gamesPlayed) * 100;
	}

	// Display win percentage
	document.getElementById('win-percentage').textContent = winPercentage.toFixed(2) + '%';
</script>
{% endblock %}