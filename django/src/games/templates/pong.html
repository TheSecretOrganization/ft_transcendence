{% extends "./extends/base.html" %}

{% block content %}
<div class="container-fluid">
	<div class="row justify-content-center align-items-center w-35 h-100">
		<div class="col-12 col-md-3" id="main-pong-column">
			<div game-menu="main" class="row">
				<a class="btn pong-selection-buttons pong-btn-scnd-color text-decoration-none mb-4 w-100 fw-bold"
					data-route href="/pong/local">Local Game</a>
				<button class="btn pong-selection-buttons mt-4 w-100 fw-bold" menu-id="online">Online Play</button>
			</div>

			<div game-menu="online" class="row">
				<a class="btn pong-selection-buttons pong-btn-scnd-color text-decoration-none mb-2 w-100 fw-bold"
					data-route href="/pong/online">Create a
					Room</a>
				<button class="btn pong-selection-buttons text-decoration-none mt-2 mb-4 w-100 fw-bold"
					menu-id="join">Join a Room</button>
				<hr class="row-divider">
				<a class="btn pong-selection-buttons pong-btn-scnd-color text-decoration-none my-4 w-100 fw-bold"
					data-route href="/tournament/pong">Join a Tournament</a>
			</div>

			<div game-menu="join" class="row w-100">
				<form class="form-group my-4 w-100" id="join-form">
					<div class="form-floating w-100 room-input-container mb-4">
						<input class="form-control w-100 room-input" type="text" id="join-id" placeholder="Room Id">
						<label id="join-label" for="join-id" class="room-input">Room ID</label>
					</div>
					<button type="submit"
						class="btn pong-selection-buttons pong-btn-scnd-color text-decoration-none mb-4 w-100 fw-bold">Join</button>
				</form>
			</div>

			<button class="btn pong-selection-buttons px-3 w-90 h-90 mx-auto fw-bold" id="back-btn"
				menu-id="main">Back</button>
		</div>
	</div>
</div>

<script>
	const url = "pong"
	const backBtn = document.getElementById("back-btn");

	function showMenu(menuId) {
		document.querySelectorAll("[game-menu]").forEach(menu => {
			menu.style.display = menu.getAttribute("game-menu") === menuId ? "block" : "none";
		});
		menuId === "main" ? backBtn.classList.add("hidden") : backBtn.classList.remove("hidden");
	}

	document.querySelectorAll('[menu-id]').forEach(element => {
		element.addEventListener("click", (e) => {
			e.preventDefault();
			showMenu(element.getAttribute("menu-id"));
		});
	});

	document.getElementById("join-form").addEventListener("submit", e => {
		e.preventDefault();
		const roomId = document.getElementById('join-id').value.trim();
		document.getElementById('join-id').value = "";
		if (roomId !== "")
			route(`/pong/online/${roomId}`);
		else
			console.error('Room ID cannot be empty.');
	});

	showMenu("main");
</script>
{% endblock %}
